<html>
<head>
    <link rel="stylesheet" href="lib/css/bootstrap.min.css">
    <style>
        body{
            background-color: #cccccc;
        }
        button{
            color: #0088cc;
            background-color: #000000;
            border: none;
            padding: 7px 10px 7px 10px;
            font-size: 15px;
        }
        input{
            background-color: #000000;
            color: #0088cc;
            border: none;
            font-size: 15px;
        }
    </style>
</head>
<body>
<center>
    <h1>Remote Assist Demo (Client)</h1>
    <img style="width: 150px; height: 45px" src="http://nodeblog.files.wordpress.com/2011/07/nodejs.png">
</center>
<a href="#myModal" class="btn" data-toggle="modal">Request Assistance</a>
<p>Some Really confusing form</p>
Acct Type<br />
<select id="MySelect">
    <option value="checking">Checking</option>
    <option value="savings">Savings</option>
    <option value="pre-paid">Pre-Paid</option>
    <option value="loan">Loan</option>
</select><br />
Acct#<br />
<input><br /><br />
Blood Type<br />
<input><br /><br />
Cubed Root of 360<br />
<input><br /><br />
Neighbor's Middle Name<br />
<input>
<br />
<button onclick="$(this).replaceWith('<input>')">Add</button>

<!-- Modal -->
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
        <h3 id="myModalLabel">Create Password</h3>
    </div>
    <div class="modal-body">
        <p>Enter a Key to provide to the representative</p>
        <input id="SessionKey">
    </div>
    <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
        <button class="btn btn-primary" onclick="CreateSession();">Save</button>
    </div>
</div>


<button onclick="addElement();">Add</button>
<button onclick="hideShow();">Hide/Show</button>
<button onclick="removeElement();">Remove</button>
<button onclick="showIndex();">Show Index</button>
<div id="Stuff"></div>
</body>
<script type="text/javascript" src="lib/js/mutation_summary.js"></script>
<script type="text/javascript" src="lib/js/tree_mirror.js"></script>
<script type="text/javascript" src="lib/js/jquery.js"></script>
<script type="text/javascript" src='http://localhost:3001/socket.io/socket.io.js'></script>
<script type="text/javascript" src="lib/js/bootstrap.min.js"></script>
<script type="text/javascript">
    socket = io.connect('http://localhost:3001');
    function addElement(){
        $('#Stuff').append('<input><br />');
    }
    function hideShow(){
        $('#Stuff').children('input').toggle();
    }
    function removeElement(){
        $('#Stuff').children('input').remove();
    }
    function showIndex(){
        $('#Stuff').children('input').each(function(){
            $(this).attr('value',$(this).index());
        });
    }

    function socketSend(msg) {
        socket.emit('changeHappened', msg);
    }

    window.addEventListener('load', function() {
        startMirroring();
    });

    function startMirroring() {
        var mirrorClient;

        socket.on('connect',function() {
            socketSend({ base: location.href.match(/^(.*\/)[^\/]*$/)[1] });
            mirrorClient = new TreeMirrorClient(document, {
                initialize: function(rootId, children) {
                    socketSend({
                        f: 'initialize',
                        args: [rootId, children]
                    });
                },

                applyChanged: function(removed, addedOrMoved, attributes, text) {
                    socketSend({
                        f: 'applyChanged',
                        args: [removed, addedOrMoved, attributes, text]
                    });
                }
            });
        });
    }
</script>
</html>